---
title: "DataViz_MidTerm"
author: "Emma Horton"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
Dataset: https://github.com/rfordatascience/tidytuesday/tree/main/data/2024/2024-02-13
```{r}
library(ggplot2)
library(dplyr)
library(tidyr)
library(plotly)
library(ggcorrplot)  
library(tidyverse)
library(scales)
```

```{r}
gifts_age <- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2024/2024-02-13/gifts_age.csv")
colnames(gifts_age)
gifts_gender <- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2024/2024-02-13/gifts_gender.csv")
colnames(gifts_gender)
historical_spending <- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2024/2024-02-13/historical_spending.csv")
colnames(historical_spending)
```
For some of the charts below, you should also show what happens when you take a third or fourth variable (categorical or quantitative) into account, by using tools such as faceting or other coloring dots in a scatterplot.

A chart that shows the distribution of a single categorical variable
```{r}
age_spending_distribution <- gifts_age %>%
  mutate(TotalSpending = rowSums(select(., -Age))) %>%
  arrange(desc(TotalSpending))

plot_ly(
  data = age_spending_distribution,
  x = ~Age,
  y = ~TotalSpending,
  type = 'bar',
  marker = list(color = 'rgba(100, 149, 237, 0.7)',
                line = list(color = 'rgba(100, 149, 237, 1)', width = 1))
) %>%
  layout(
    title = "Distribution of Total Valentine's Day Spending by Age",
    xaxis = list(title = "Age"),
    yaxis = list(title = "Total Spending (USD)"),
    showlegend = FALSE
  )


```



A chart that shows the distribution of a single quantitative variable
```{r}

plot_ly(
  data = historical_spending,
  x = ~PerPerson,
  type = "histogram",
  nbinsx = 10,
  marker = list(color = 'rgba(0, 191, 165, 0.6)',
                line = list(color = 'rgba(0, 191, 165, 1.0)', width = 1))
) %>%
  layout(
    title = "Distribution of Per-Person Valentine's Day Spending (2000â€“2024)",
    xaxis = list(title = "Spending Per Person (USD)"),
    yaxis = list(title = "Number of Years"),
    bargap = 0.1
  )


```

```{r}

plot_ly(
  data = historical_spending,
  x = ~Year,
  y = ~PerPerson,
  type = 'scatter',
  mode = 'lines+markers',
  line = list(color = 'royalblue', width = 2),
  marker = list(size = 7)
) %>%
  layout(
    title = "Average Per-Person Valentine's Day Spending by Year",
    xaxis = list(title = "Year"),
    yaxis = list(title = "Spending Per Person (USD)", tickprefix = "$"),
    hovermode = "x unified"
  )

```



A chart that shows the distribution of two categorical variables
```{r}
gender_long <- gifts_gender %>%
  pivot_longer(cols = -Gender, names_to = "Category", values_to = "Spending")

plot_ly(
  data = gender_long,
  x = ~Category,
  y = ~Spending,
  color = ~Gender,
  type = 'bar'
) %>%
  layout(
    barmode = 'group',
    title = "Spending by Gender and Gift Category",
    xaxis = list(title = "Gift Category"),
    yaxis = list(title = "Average Spending (USD)", tickprefix = "$"),
    legend = list(title = list(text = "<b>Gender</b>")),
    margin = list(b = 100)
  )

```

A chart that shows the distribution of a quantitative variable across categories of a categorical variable
```{r}
plot_ly(
  data = gifts_age,
  x = ~Age,
  y = ~Jewelry,
  type = 'bar',
  marker = list(color = 'rgba(186,85,211,0.7)',
                line = list(color = 'rgba(186,85,211,1.0)', width = 1))
) %>%
  layout(
    title = "Jewelry Spending by Age Group",
    xaxis = list(title = "Age"),
    yaxis = list(title = "Average Jewelry Spending (USD)", tickprefix = "$"),
    margin = list(b = 100)
  )

```

A chart that shows the relationship between two quantitative variables
```{r}
plot_ly(
  data = gifts_age,
  x = ~EveningOut,
  y = ~Jewelry,
  type = 'scatter',
  mode = 'markers',
  text = ~paste("Age:", Age),
  marker = list(
    size = 10,
    color = 'rgba(255, 140, 0, 0.7)',
    line = list(width = 1, color = 'rgba(255, 140, 0, 1)')
  )
) %>%
  layout(
    title = "Relationship Between Evening Out and Jewelry Spending",
    xaxis = list(title = "Evening Out Spending (USD)", tickprefix = "$"),
    yaxis = list(title = "Jewelry Spending (USD)", tickprefix = "$"),
    hovermode = "closest"
  )


```

